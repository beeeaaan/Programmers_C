#include <string>
#include <vector>

using namespace std;

int solution(string dartResult) {
    vector<int> score(3,0);
    int num = 0, idx = -1;
    for (int i = 0; i < dartResult.length(); i++) {
        int cnt = dartResult[i] - '0';
        
        // 숫자인 경우
        if (cnt >= 0 && cnt <= 10) {
            if (num == -1)
                num = 0;
            num = num * 10 + cnt;
        // 문자인 경우
        } else {
            // 숫자에서 문자로 바뀐 직후인 경우
            if (num != -1) {
                idx += 1;
                score[idx] = num;
                num = -1;
            } if (dartResult[i]=='D') {
                score[idx] = score[idx] * score[idx];
            } else if (dartResult[i]=='T') {
                score[idx] = score[idx] * score[idx] * score[idx];
            } else if (dartResult[i] == '*') {
                for (int j = idx; j >= max(0, idx-1); j--) {
                    score[j] *= 2;
                }
            } else if (dartResult[i] == '#') {
                score[idx] *= -1;
            }
        }
    }
        
    return score[0] + score[1] + score[2];
}
